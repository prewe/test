<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    
    <div class="container">
		<div class="calendar__header">
			<div class="prev" onclick="prev()">Prev</div>
			<div class="month-and-year"></div>
			<div class="next" onclick="next()">Next</div>
		</div>
		
		<div id="calendar" class="calendar"></div>
	</div>


    <script>

		  let today = new Date();
			let currMonth = today.getMonth();
			let currYear = today.getFullYear();
			let months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

			createCalendar("calendar", currYear, currMonth);
			monthAndYear();

			function monthAndYear() {
				let monthAndYearContainer = document.querySelector('.month-and-year');
				monthAndYearContainer.innerHTML = months[currMonth] + " " + currYear;
			}

			function prev() {
				currYear = (currMonth === 0) ? currYear - 1 : currYear;
				currMonth = (currMonth === 0) ? 11 : currMonth - 1;
				createCalendar("calendar", currYear, currMonth);
				monthAndYear();
			}

			function next() {
				currYear = (currMonth === 11) ? currYear + 1 : currYear;
				currMonth = (currMonth + 1) % 12;
				createCalendar("calendar", currYear, currMonth);
				monthAndYear();
			}

      function createCalendar(id, year, month) {
        var elem = document.querySelector('#' + id);
        var mon = month; // месяцы в JS идут от 0 до 11, а не от 1 до 12
        var d = new Date(year, mon);
        var table = '<table><tr><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th><th>вс</th></tr><tr>';
    
          // заполнить первый ряд от понедельника
          // и до дня, с которого начинается месяц
          // * * * | 1  2  3  4
        for (var i = 0; i < getDay(d); i++) {
          table += '<td></td>';
        }
    
          // ячейки календаря с датами
        while (d.getMonth() == mon) {
          table += '<td>' + d.getDate() + '</td>';
    
          if (getDay(d) % 7 == 6) { // вс, последний день - перевод строки
            table += '</tr><tr>';
          }
    
          d.setDate(d.getDate() + 1);
        }

          
    
          // добить таблицу пустыми ячейками, если нужно
        if (getDay(d) != 0) {
          for (var i = getDay(d); i < 7; i++) {
            table += '<td></td>';
          }
        }
    
          // закрыть таблицу
        table += '</tr></table>';
    
          // только одно присваивание innerHTML
        elem.innerHTML = table;

        function getDay(date) { // получить номер дня недели, от 0(пн) до 6(вс)
          var day = date.getDay();
          if (day == 0) day = 7;
          return day - 1;
        }

          
        let td = document.querySelectorAll('td')
        let tbl = document.querySelector('table');
        let selectedTd;
        let now = new Date();

        tbl.addEventListener('click', function(event){
          let target = event.target;

              

          if (target.tagName != 'TD') return;
          highlight(target);
        });

        function highlight(node) {
          if (selectedTd) {
            selectedTd.classList.remove('red');
          }
          selectedTd = node;
          selectedTd.classList.add('red');
        };
          

        td.forEach(function(tds){
          if (tds.textContent == now.getDate() && mon == now.getMonth()) {
            tds.classList.add('black');
          }
        });

          

        function next() {
          currentYear = (currentMonth === 11) ? currentYear + 1 : currentYear;
          currentMonth = (currentMonth + 1) % 12;
          showCalendar(currentMonth, currentYear);
        }

        function prev() {
          currentYear = (currentMonth === 0) ? currentYear - 1 : currentYear;
          currentMonth = (currentMonth === 0) ? 11 : currentMonth - 1;
          showCalendar(currentMonth, currentYear);
        }
      }

			
 

    </script>

</body>
</html>